<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>JIA&#39;s BLOG</title>
  
  <subtitle>码字的地方</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.jiazhe.space/"/>
  <updated>2019-10-26T15:08:31.594Z</updated>
  <id>http://blog.jiazhe.space/</id>
  
  <author>
    <name>JIA LIU</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>如何在AWS上为RHEL或CentOS设定固定的主机名和域名？</title>
    <link href="http://blog.jiazhe.space/2019/10/26/How-to-properly-set-your-own-hostname-and-DNS-on-AWS/"/>
    <id>http://blog.jiazhe.space/2019/10/26/How-to-properly-set-your-own-hostname-and-DNS-on-AWS/</id>
    <published>2019-10-26T14:31:01.000Z</published>
    <updated>2019-10-26T15:08:31.594Z</updated>
    
    <content type="html"><![CDATA[<p>参考文档:<br><a href="https://amazonaws-china.com/cn/premiumsupport/knowledge-center/ec2-static-dns-ubuntu-debian/" target="_blank" rel="noopener">https://amazonaws-china.com/cn/premiumsupport/knowledge-center/ec2-static-dns-ubuntu-debian/</a><br><a href="https://amazonaws-china.com/cn/premiumsupport/knowledge-center/linux-static-hostname-rhel7-centos7/" target="_blank" rel="noopener">https://amazonaws-china.com/cn/premiumsupport/knowledge-center/linux-static-hostname-rhel7-centos7/</a></p><p>起因:<br>客户环境需要独立的解析，所以新建了DNS，forward了AWS的DNS，然后让自己所有主机指定自己自建的DNS，从而加入内部解析。</p><p>测试了一番，最主要的的几个影响因素：<br>1: VPC 设定<br>DNS resolution  // 这个如果不enable, 你所在的subnet x.x.x.2的地址不再提供解析<br>DNS hostnames   // 没测试出来有啥用，仍然能在dhcp后获取到主机名。<br>2: Cloud-init<br>抄来的 The cloud-init program is a bootstrapping utility for pre-provisioned disk images that run in virtualized environments, usually cloud-oriented services. You use it to add SSH keys, set hostnames, run post-install scripts or install provisioning agents (like Chef or Puppet).</p><p>这里可以控制resolv.conf和hostname，也是我们重要修改的地方。这里修改了，才能让hostname固定下来。<br>实测后发现,resolv.conf的修改在这里修改是存在bug的。如果想了解cloud init可以控制的内容，可以参考一下local doc里面看一下。</p><p>我自己理解了一下，但是可能是错的。就不说了。</p><p>3: NetworkManager<br>默认的RHEL/Centos的网络管理器。</p><p>4: DHCP(dhclient)<br>最后dhcp client的执行层面。</p><p>说明，整体影响因素是 1 -&gt; 2 -&gt; 3 -&gt; 4 , 从前到后，最后的具有决定性。但是中间的前面的配置影响后面的配置。</p><p>最后可以实现我的方法:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### hostname</span></span><br><span class="line">hostnamectl <span class="built_in">set</span>-hostname --static kookliu.jia.com</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"preserve_hostname: true"</span> &gt;&gt; /etc/cloud/cloud.cfg</span><br><span class="line"></span><br><span class="line"><span class="comment">#### dns</span></span><br><span class="line"></span><br><span class="line">cat &gt; /etc/dhcp/dhclient.conf &lt;&lt; EOF</span><br><span class="line">prepend domain-name-servers 114.114.114.114, 8.8.8.8;</span><br><span class="line">supersede domain-search <span class="string">"jia.com"</span>;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>结论：一定要确认，重启后，仍然是有效的。</p><p>我说一下错误的两种配置方法，重启后都丢了，你能知道为什么吧？</p><p>方法一：</p><p>1：主机名<br>hostnamectl set-hostname --static <a href="http://kookliu.jia.com" target="_blank" rel="noopener">kookliu.jia.com</a></p><p>2: DNS解析<br>cat &gt;&gt; /etc/sysconfig/network-scripts/ifcfg-eth0 &lt;&lt;TOF<br>PEERDNS=no<br>DNS1=8.8.8.8<br>DNS2=8.8.4.4<br>TOF<br>systemctl restart network</p><p>方法二：</p><p>DNS修改(存在bug,没个卵用)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-10-0-102-198 ~]<span class="comment"># cat /usr/share/doc/cloud-init/examples/cloud-config-resolv-conf.txt</span></span><br><span class="line"><span class="comment">#cloud-config</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is an example file to automatically configure resolv.conf when the</span></span><br><span class="line"><span class="comment"># instance boots for the first time.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Ensure that your yaml is valid and pass this as user-data when starting</span></span><br><span class="line"><span class="comment"># the instance. Also be sure that your cloud.cfg file includes this</span></span><br><span class="line"><span class="comment"># configuration module in the appropriate section.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">manage_resolv_conf: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">resolv_conf:</span><br><span class="line">  nameservers: [<span class="string">'8.8.4.4'</span>, <span class="string">'8.8.8.8'</span>]</span><br><span class="line">  searchdomains:</span><br><span class="line">    - foo.example.com</span><br><span class="line">    - bar.example.com</span><br><span class="line">  domain: example.com</span><br><span class="line">  options:</span><br><span class="line">    rotate: <span class="literal">true</span></span><br><span class="line">    timeout: 1</span><br><span class="line">[root@ip-10-0-102-198 ~]<span class="comment"># ls /etc/cloud/</span></span><br><span class="line">cloud.cfg    cloud.cfg.d/ templates/</span><br><span class="line">[root@ip-10-0-102-198 ~]<span class="comment"># ls /etc/cloud/cloud.cfg.d/</span></span><br><span class="line">05_logging.cfg  99-datasource.cfg  README</span><br><span class="line">[root@ip-10-0-102-198 ~]<span class="comment"># cat /usr/share/doc/cloud-init/examples/cloud-config-resolv-conf.txt &gt;&gt; 90_dns.cfg</span></span><br></pre></td></tr></table></figure><p>花了很长时间debug这个问题。没有结果。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;参考文档:&lt;br&gt;
&lt;a href=&quot;https://amazonaws-china.com/cn/premiumsupport/knowledge-center/ec2-static-dns-ubuntu-debian/&quot; target=&quot;_blank&quot; rel=&quot;noo
      
    
    </summary>
    
    
      <category term="AWS" scheme="http://blog.jiazhe.space/tags/AWS/"/>
    
  </entry>
  
  <entry>
    <title>AWS Storage Gateway 初探</title>
    <link href="http://blog.jiazhe.space/2019/06/06/Preliminary-study-aws-storage-gateway/"/>
    <id>http://blog.jiazhe.space/2019/06/06/Preliminary-study-aws-storage-gateway/</id>
    <published>2019-06-06T01:57:52.923Z</published>
    <updated>2019-06-06T03:13:56.484Z</updated>
    
    <content type="html"><![CDATA[<p>这个东西终于用了一下，先文字描述一下，慨叹一下这个东西设计的确实挺牛逼的。当前场景使用的只是文件网关。</p><p>功能：这个东西简单来说，如果你是私有云，可以用AWS提供的一个VM，在你的线下环境部署，然后和AWS进行同步，将数据写到AWS的S3上去。这里说是同步，其实是一个Cache,因为不是线上数据对等的，因为这个磁盘决定不可能和线上一样大的。在使用中会显示为8EB。但是实际上你的缓存服务器可能是500GB，取决你自己的设定。</p><p>缩成一句话就是：将线上的S3映射成本地的一个Samba/NFS服务提供给本地的Windows/Linux进行使用。</p><p>大概描述完了，再说一下AWS的这个配置方法。<br>1：让你选一个介质。部署在本地或者云上。介质类型有VMware OVA/Hyper-V/EC2 AMI<br>1.5: 这个步骤，等同于你在线下或者线上，部署完了这个VM。就可以了。<br>2：填写这个VM所在IP。  \ 最重要的问题就在这里，请问你如果是线下，这个VM是否需要公网IP?  如果是云上呢？<br>3：完成配置。</p><p>这个牛逼的地方就是2这个步骤里面，如果你的Agent就在内网部署，你觉得能够正确完成配置吗？<br>解答：事实上就是能。但是需要你的当前配置的Workstation，也就是你正在做这个配置的笔记本或者台式机，能正常访问到Agent的80/443, 在进行2配置的时候，会从AWS 云上下载一个API调用的临时文件，然后跳转到Agent_IP:80上，完成这个信息注入，从而将这台Agent注册到AWS云上的Storage Gateway上的对端服务上。 也就是你的Workstation作为这个配置的一部分了。这个设计是真的牛逼。</p><p>补充一个问题，如果是云上呢？你的EC2 AMI是否需要公网IP吗？想一想。考虑这个答案。</p><p><font color="#FF0000"><strong>所以在这个配置里面真正的条件就是。你的Workstation在那个页面跳转后，你当前的网络能访问到Agent的IP吗?</strong></font></p><p>所以你答案你清楚了吧？ 是否是公网IP不重要，只要你的Agent能通过Internet能访问到AWS，因为是你线下主动发起的。在NAT后面也完全无所谓。</p><p>先这样，回头抽空补图。</p><p>补图：</p><p><img src="01.jpg" alt=""><br><img src="02.jpg" alt=""><br><img src="03.jpg" alt=""><br>看这里，正在线上生成东西，下载到本地。等待跳转。<br><img src="04.jpg" alt=""><br>这里跳转了，看页面。由于为了演示这个效果。所以这个地址实际上我本地没有配。<br><img src="05.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;这个东西终于用了一下，先文字描述一下，慨叹一下这个东西设计的确实挺牛逼的。当前场景使用的只是文件网关。&lt;/p&gt;
&lt;p&gt;功能：这个东西简单来说，如果你是私有云，可以用AWS提供的一个VM，在你的线下环境部署，然后和AWS进行同步，将数据写到AWS的S3上去。这里说是同步，其实
      
    
    </summary>
    
    
      <category term="AWS Storage Gateway" scheme="http://blog.jiazhe.space/tags/AWS-Storage-Gateway/"/>
    
      <category term="Hybird Cloud" scheme="http://blog.jiazhe.space/tags/Hybird-Cloud/"/>
    
  </entry>
  
  <entry>
    <title>如何在Private Subnet下使用S3 Endpoint?</title>
    <link href="http://blog.jiazhe.space/2019/06/05/How-to-access-s3-endpoint-from-private-subent/"/>
    <id>http://blog.jiazhe.space/2019/06/05/How-to-access-s3-endpoint-from-private-subent/</id>
    <published>2019-06-05T14:13:19.047Z</published>
    <updated>2019-09-17T23:38:08.997Z</updated>
    
    <content type="html"><![CDATA[<p>测试说明：EC2在一个Private Subnet下，并且没有NAT,只有一个VPC的Local Route,然后添加S3 Endpoint,指向这个EC2所在的Subnet，确保这个Subnet存在了路由指向了这个S3 Endpoint。</p><p>坑：MD，我以为在Endpoint页面看到的com.amazonaws.cn-northwest-1.s3，就是endpoint的访问URL，但是并不是啊，啊！！！！！<br>需要看去文档：<a href="https://docs.amazonaws.cn/general/latest/gr/rande.html#cnnorthwest_region" target="_blank" rel="noopener">https://docs.amazonaws.cn/general/latest/gr/rande.html#cnnorthwest_region</a> ,<br>我当前是宁夏，所以是这个路径：<a href="http://s3.cn-northwest-1.amazonaws.com.cn" target="_blank" rel="noopener">s3.cn-northwest-1.amazonaws.com.cn</a></p><p>如图示：<br><img src="01.jpg" alt=""></p><p>系统层面实际上应该访问的是：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-172-17-17-222 ~]# nslookup s3.cn-northwest-1.amazonaws.com.cn</span><br><span class="line">Server:172.17.0.2</span><br><span class="line">Address:172.17.0.2#53</span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:s3.cn-northwest-1.amazonaws.com.cn</span><br><span class="line">Address: 52.82.190.29</span><br><span class="line"></span><br><span class="line">[root@ip-172-17-17-222 ~]# ping s3.cn-northwest-1.amazonaws.com.cn</span><br><span class="line">PING s3.cn-northwest-1.amazonaws.com.cn (52.82.188.33) 56(84) bytes of data.</span><br><span class="line">64 bytes from 52.82.188.33 (52.82.188.33): icmp_seq=1 ttl=60 time=0.201 ms</span><br><span class="line">64 bytes from 52.82.188.33 (52.82.188.33): icmp_seq=2 ttl=60 time=0.233 ms</span><br><span class="line">--- s3.cn-northwest-1.amazonaws.com.cn ping statistics ---</span><br><span class="line">2 packets transmitted, 2 received, 0% packet loss, time 1001ms</span><br><span class="line">rtt min/avg/max/mdev = 0.201/0.217/0.233/0.016 ms</span><br><span class="line"></span><br><span class="line">[root@ip-172-17-17-222 ~]# ping www.baidu.com</span><br><span class="line">PING www.a.shifen.com (220.181.38.149) 56(84) bytes of data.</span><br><span class="line">--- www.a.shifen.com ping statistics ---</span><br><span class="line">3 packets transmitted, 0 received, 100% packet loss, time 2049ms</span><br><span class="line"></span><br><span class="line">[root@ip-172-17-17-222 ~]# aws s3 ls --region cn-northwest-1</span><br><span class="line">2019-01-18 01:59:23 bj-s3-xxxxx</span><br><span class="line">2019-04-27 11:31:20 cf-templates-yhk48sv0blj1-cn-north-1</span><br><span class="line">2019-03-28 03:22:54 xxxxxx</span><br><span class="line">2019-06-04 04:01:17 nx-s3-xxxxx</span><br><span class="line">2018-09-14 05:59:34 xxxxxxx</span><br></pre></td></tr></table></figure><p>总结：EC2是通过Role授权的方式来进行调用的，网络确实没有走公网。因为subnet里面直接加了一个路由。直接怼到那个公网IP.由于这个原理，所以只能每个Subnet加一个。也就是在AZ层面有效。扩展想一下，如果是HA想调用EC2呢？需要两边的EC2都调整一下。</p><p><img src="02.jpg" alt=""></p><p>20190918 add<br>增加endpiont不是意味着只能访问自己的Service, 而是你有AK/SK的情况下，或者适合的role的情况下，可以访问任何Account下的资源。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;测试说明：EC2在一个Private Subnet下，并且没有NAT,只有一个VPC的Local Route,然后添加S3 Endpoint,指向这个EC2所在的Subnet，确保这个Subnet存在了路由指向了这个S3 Endpoint。&lt;/p&gt;
&lt;p&gt;坑：MD，我以为在
      
    
    </summary>
    
    
      <category term="Endpoints" scheme="http://blog.jiazhe.space/tags/Endpoints/"/>
    
  </entry>
  
  <entry>
    <title>如何以Region来批处理获取AMI ID？</title>
    <link href="http://blog.jiazhe.space/2019/05/24/How%20to%20get%20the%20AMI%20ID%20in%20batch%20by%20region/"/>
    <id>http://blog.jiazhe.space/2019/05/24/How to get the AMI ID in batch by region/</id>
    <published>2019-05-24T11:31:32.854Z</published>
    <updated>2019-05-24T11:42:53.111Z</updated>
    
    <content type="html"><![CDATA[<p>这个其实也是为CloudFormation服务的，就是为了批处理获取。<br>使用方法如下：<br>1：一个参数文件，通过上一篇文章进行获取。其实就是AMI的列表清单。<br>2：直接执行脚本调用，加上参数文件。</p><p>具体效果如下，如您所见</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">bogon:aws-kp jialj$ ./get-BIID.sh list </span><br><span class="line">+++++ This Region is eu-north-1 +++++++</span><br><span class="line">AMZNLINUXHVM: <span class="string">"ami-6d27a913"</span></span><br><span class="line">CENTOS7HVM: <span class="string">"ami-5ee66f20"</span></span><br><span class="line">US1404HVM: null</span><br><span class="line">US1604HVM: <span class="string">"ami-844ec6fa"</span></span><br><span class="line">SLES15HVM: null</span><br><span class="line">+++++ This Region is ap-south-1 +++++++</span><br><span class="line">AMZNLINUXHVM: <span class="string">"ami-0937dcc711d38ef3f"</span></span><br><span class="line">CENTOS7HVM: <span class="string">"ami-02e60be79e78fef21"</span></span><br><span class="line">US1404HVM: <span class="string">"ami-0f7148fa46b2632de"</span></span><br><span class="line">US1604HVM: <span class="string">"ami-0dd423361176c4c3e"</span></span><br><span class="line">SLES15HVM: <span class="string">"ami-03e5ec9da485cf78d"</span></span><br><span class="line">+++++ This Region is eu-west-3 +++++++</span><br><span class="line">AMZNLINUXHVM: <span class="string">"ami-0854d53ce963f69d8"</span></span><br><span class="line">CENTOS7HVM: <span class="string">"ami-0e1ab783dc9489f34"</span></span><br><span class="line">US1404HVM: <span class="string">"ami-0d6e5468607f10c4c"</span></span><br><span class="line">US1604HVM: <span class="string">"ami-0ed8bedf213030d40"</span></span><br><span class="line">SLES15HVM: <span class="string">"ami-0c754746fa7bb159f"</span></span><br><span class="line">+++++ This Region is eu-west-2 +++++++</span><br><span class="line">AMZNLINUXHVM: <span class="string">"ami-0664a710233d7c148"</span></span><br><span class="line">CENTOS7HVM: <span class="string">"ami-0eab3a90fc693af19"</span></span><br><span class="line">US1404HVM: <span class="string">"ami-02c7fa53678183d21"</span></span><br><span class="line">US1604HVM: <span class="string">"ami-04f1828daa77e5c19"</span></span><br><span class="line">SLES15HVM: <span class="string">"ami-2cce3b4b"</span></span><br><span class="line">+++++ This Region is eu-west-1 +++++++</span><br><span class="line">AMZNLINUXHVM: <span class="string">"ami-0fad7378adf284ce0"</span></span><br><span class="line">CENTOS7HVM: <span class="string">"ami-0ff760d16d9497662"</span></span><br><span class="line">US1404HVM: <span class="string">"ami-0a7d0c99e3408ca73"</span></span><br><span class="line">US1604HVM: <span class="string">"ami-0cbf7a0c36bde57c9"</span></span><br><span class="line">SLES15HVM: <span class="string">"ami-0533a134eaeabea0f"</span></span><br><span class="line">+++++ This Region is ap-northeast-3 +++++++</span><br><span class="line">AMZNLINUXHVM: <span class="string">"ami-02221e80207be5561"</span></span><br><span class="line">CENTOS7HVM: <span class="string">"ami-054dd155c89b8d778"</span></span><br><span class="line">US1404HVM: <span class="string">"ami-0b0dee6b7b98d4b16"</span></span><br><span class="line">US1604HVM: <span class="string">"ami-03602d38ba6801e13"</span></span><br><span class="line">SLES15HVM: null</span><br><span class="line">.....</span><br><span class="line">.....</span><br></pre></td></tr></table></figure><p>参数文件写法：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bogon:aws-test kook$ cat list</span><br><span class="line">AMZNLINUXHVM:amzn2-ami-hvm-2.0.20190115-x86_64-gp2</span><br><span class="line">CENTOS7HVM:CentOS Linux 7 x86_64 HVM EBS ENA 1901_01-b7ee8a69-ee97-4a49-9e68-afaee216db2e-ami-05713873c6794f575.4</span><br><span class="line">US1404HVM:ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20190429</span><br><span class="line">US1604HVM:ubuntu/images/hvm-ssd/ubuntu-xenial-16.04-amd64-server-20190514</span><br><span class="line">SLES15HVM:suse-sles-sap-15-v20180806-hvm-ssd-x86_64-6a4bc5af-a084-4f96-8402-5cd249e9091d-ami-06aee2e6db735d4f4.4</span><br></pre></td></tr></table></figure><p>脚本内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$1</span>"</span> ] ; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Please pass the name of the AMI"</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">INPUT=<span class="string">"<span class="variable">$&#123;1&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">declare</span> -a REGIONS=($( aws --profile hk ec2 describe-regions --output json | jq <span class="string">'.Regions[].RegionName'</span> | sed <span class="string">'s/\"//g'</span> ))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;REGIONS[@]&#125;</span>"</span></span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line"><span class="built_in">echo</span> <span class="string">"+++++ This Region is <span class="variable">$i</span> +++++++"</span></span><br><span class="line">cat <span class="variable">$INPUT</span> | <span class="keyword">while</span> <span class="built_in">read</span> line</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">AMI_LIST=$(<span class="built_in">echo</span> <span class="variable">$line</span> | awk -F: <span class="string">'&#123;print $2&#125;'</span>)</span><br><span class="line">AMI_ALIAS=$(<span class="built_in">echo</span> <span class="variable">$line</span> | awk -F: <span class="string">'&#123;print $1&#125;'</span> )</span><br><span class="line">IMAGE_FILTER=<span class="string">"<span class="variable">$&#123;AMI_LIST&#125;</span>"</span></span><br><span class="line">     ami=$(aws --profile hk ec2 describe-images --query <span class="string">'Images[*].[ImageId]'</span> --filters <span class="string">"Name=name,Values=<span class="variable">$&#123;IMAGE_FILTER&#125;</span>"</span> --region <span class="variable">$&#123;i&#125;</span> --output json | jq <span class="string">'.[0][0]'</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$AMI_ALIAS</span>: <span class="variable">$ami</span>"</span></span><br><span class="line"> <span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;这个其实也是为CloudFormation服务的，就是为了批处理获取。&lt;br&gt;
使用方法如下：&lt;br&gt;
1：一个参数文件，通过上一篇文章进行获取。其实就是AMI的列表清单。&lt;br&gt;
2：直接执行脚本调用，加上参数文件。&lt;/p&gt;
&lt;p&gt;具体效果如下，如您所见&lt;/p&gt;
&lt;fig
      
    
    </summary>
    
      <category term="Automation" scheme="http://blog.jiazhe.space/categories/Automation/"/>
    
    
      <category term="CloudFormation" scheme="http://blog.jiazhe.space/tags/CloudFormation/"/>
    
  </entry>
  
  <entry>
    <title>CloudFormation -  如何获取AWS的AMI ID？</title>
    <link href="http://blog.jiazhe.space/2019/05/22/CloudFormation%20-%20How%20to%20get%20AMI%20ID/"/>
    <id>http://blog.jiazhe.space/2019/05/22/CloudFormation - How to get AMI ID/</id>
    <published>2019-05-22T08:24:27.382Z</published>
    <updated>2019-08-20T06:02:21.911Z</updated>
    
    <content type="html"><![CDATA[<p>目前正在做CloudFormation的一些工作相关内容，Hong Kong Region是新开的Region，所以Global的一般提供的QuickStart里面的AMI Mapping都没有HK的内容。所以需要提取一下Hong Kong的内容。</p><p>概述：AMI ID是依据Owner去分类的，默认情况下分为amazon,aws-marketplace,microsoft,所以这里要注意你的AMI是属于哪个Owner下的。</p><p>一：获取一下AMI的名字</p><p>注意，Owner分别以amazon和aws-marketplace的输出信息。参数是：–owners</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">bogon:aws-test kook$ aws --profile hk  ec2 describe-images --owners amazon --filters "Name=name,Values=ubuntu*" --query 'sort_by(Images, &amp;CreationDate)[].Name'</span><br><span class="line">[</span><br><span class="line">    <span class="string">"ubuntu-bionic-18.04-amd64-server-20180522-dotnetcore-2018.07.11"</span>,</span><br><span class="line">    <span class="string">"ubuntu-xenial-16.04-amd64-server-20180306-SQL_2017_Express-2018.04.10"</span>,</span><br><span class="line">    <span class="string">"ubuntu-xenial-16.04-amd64-server-20180306-SQL_2017_Web-2018.04.10"</span>,</span><br><span class="line">    <span class="string">"ubuntu-xenial-16.04-amd64-server-20180306-SQL_2017_Standard-2018.04.10"</span>,</span><br><span class="line">    <span class="string">"ubuntu-xenial-16.04-amd64-server-20180306-SQL_2017_Enterprise-2018.04.10"</span>,</span><br><span class="line">    <span class="string">"ubuntu-xenial-16.04-amd64-server-20190212-SQL_2017_Enterprise-2019.04.02"</span>,</span><br><span class="line">    <span class="string">"ubuntu-xenial-16.04-amd64-server-20190212-SQL_2017_Express-2019.04.02"</span>,</span><br><span class="line">    <span class="string">"ubuntu-xenial-16.04-amd64-server-20190212-SQL_2017_Standard-2019.04.02"</span>,</span><br><span class="line">    <span class="string">"ubuntu-xenial-16.04-amd64-server-20190212-SQL_2017_Web-2019.04.02"</span></span><br><span class="line">]</span><br><span class="line">bogon:aws-test kook$ aws --profile hk  ec2 describe-images --owners aws-marketplace --filters "Name=name,Values=ubuntu*" --query 'sort_by(Images, &amp;CreationDate)[].Name'</span><br><span class="line">[</span><br><span class="line">    <span class="string">"ubuntu-18.04-VE6.0.1r5-1-1e5137b8-671e-41cc-b8d3-9c2b49256285-ami-02b04c73754e39143.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-18.04-VC6.1.1-1-3b49f79c-3119-4843-87fa-1913bbfd0734-ami-01e67bda7e5b22917.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-18.04-VAC3.8.1-1-66afc72d-1cbd-47e1-82f5-2cb033e6b72b-ami-0e77341461ea68812.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-16.04-VC4.1.10-1-62ab724f-833e-4666-99d0-21e3ec7ad743-ami-0a2ef36dad6e99237.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-14.04-VCP4.1.10r6-1-5dfb4110-fc9c-4c64-9551-6b9283cd47ef-ami-02db394d7c4de1e1c.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-18.04-VCS6.0.1-1-e7fe31ca-ada8-4e55-8fec-fb5b03dc7ef8-ami-08cb6ed9610ed5802.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-16.04__KNIME_Server_4.7.2-SRV-4.7.2-2018-09-06-17ecdb3d-6740-419f-b825-bf418bba360d-ami-03ac37929efc450b5.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-16.04__KNIME_Server_4.7.2-SRV-4.7.2-byol-2018-09-06-c96b84cf-13e0-4a4b-a371-167af56c3e94-ami-0ec9137c74a0a54ff.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-16.04__KNIME_Server_small_4.7.3-SRV-4.7.3-2018-11-15-5deef161-954a-4b84-9285-e76ab409e2e7-ami-0a354008ae2f6ada5.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-pio-0.2.2-45fa7f6f-a9ed-48e0-8017-c4e89711a22c-ami-3c98f343.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu/images/hvm-ssd/ubuntu-disco-19.04-arm64-server-20190417-d1a42a4a-e17d-4d2b-91f3-8f55643a7fd9-ami-00261a6a6a8290d46.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu/images/hvm-ssd/ubuntu-trusty-14.04-amd64-server-20190429-bb634ce9-ed92-47ac-a3dc-66e8ab3aaf75-ami-0bc0814ce7c141032.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-minimal/images/hvm-ssd/ubuntu-bionic-18.04-amd64-minimal-201-0641ddeb-4f55-4c19-a94b-5c409a5e0164-ami-0304b46b71888b817.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu/images/hvm-ssd/ubuntu-bionic-18.04-amd64-server-20190514-3b73ef49-208f-47e1-8a6e-4ae768d8a333-ami-024a64a6685d05041.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu/images/hvm-ssd/ubuntu-cosmic-18.10-amd64-server-20190514-6dc2bdb9-c084-41f0-9949-d762044b4e40-ami-0cfb1692986ab3a84.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu/images/hvm-ssd/ubuntu-disco-19.04-amd64-server-20190514-7f42d8d0-b1f1-46be-9fb5-50ce0f1a4e67-ami-08ab45c4343f5f5c6.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-minimal/images/hvm-ssd/ubuntu-cosmic-18.10-amd64-minimal-201-c040a41e-90ce-489f-8a6c-5a576b56756e-ami-0b7e0f7d70c03333a.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu/images/hvm-ssd/ubuntu-xenial-16.04-amd64-server-20190514-d83d0782-cb94-46d7-8993-f4ce15d1a484-ami-07b4156579ea1d7ba.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-minimal/images/hvm-ssd/ubuntu-xenial-16.04-amd64-minimal-201-d88fb28e-20e8-4254-8147-30cac1406e6e-ami-04564bfadb4d806a2.4"</span>,</span><br><span class="line">    <span class="string">"ubuntu-minimal/images/hvm-ssd/ubuntu-disco-19.04-amd64-minimal-2019-2c31cc1c-94d4-400f-96ba-1e7ae4701a2a-ami-0e24a536dc1d8f8ae.4"</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>二：获取这个AMI的ID</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">bogon:aws-test kook$ aws --profile hk  ec2 describe-images --owners amazon --filters "Name=name,Values=amzn*" --query 'sort_by(Images, &amp;CreationDate)[].Name'</span><br><span class="line">[</span><br><span class="line">    <span class="string">"amzn-ami-hvm-2018.03.0.20181129-x86_64-s3"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-hvm-2018.03.0.20181129-x86_64-s3"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-hvm-2018.03.0.20181129-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-hvm-2018.03.0.20181129-x86_64-gp2"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-minimal-hvm-2018.03.0.20181129-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-minimal-hvm-2.0.20190115-arm64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-minimal-hvm-2.0.20190115-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20190115-arm64-gp2"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20190115-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20190115-x86_64-gp2"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-minimal-hvm-2018.03.0.20181129-x86_64-s3"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20180622.1-x86_64-gp2-dotnetcore-2018.12.12"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20180622.1-x86_64-gp2-SQL_2017_Express-2018.08.15"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20180622.1-x86_64-gp2-SQL_2017_Web-2018.08.15"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20180622.1-x86_64-gp2-SQL_2017_Standard-2018.08.15"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20180622.1-x86_64-gp2-SQL_2017_Enterprise-2018.08.15"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-vpc-nat-hvm-2018.03.0.20181116.1-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-2018.03.n-amazon-ecs-optimized"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20180622.1-x86_64-gp2-dotnetcore-2019.04.09"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-ecs-hvm-2.0.20190402-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-ecs-gpu-hvm-2.0.20190402-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-2018.03.p-amazon-ecs-optimized"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-ecs-hvm-2.0.20190510-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-2018.03.q-amazon-ecs-optimized"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-ecs-gpu-hvm-2.0.20190510-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20190313-x86_64-gp2-SQL_2017_Enterprise-2019.04.02"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20190313-x86_64-gp2-SQL_2017_Express-2019.04.02"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20190313-x86_64-gp2-SQL_2017_Standard-2019.04.02"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20190313-x86_64-gp2-SQL_2017_Web-2019.04.02"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-hvm-2018.03.0.20190514-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-hvm-2018.03.0.20190514-x86_64-gp2"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-minimal-hvm-2018.03.0.20190514-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20190508-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-hvm-2.0.20190508-x86_64-gp2"</span>,</span><br><span class="line">    <span class="string">"amzn2-ami-minimal-hvm-2.0.20190508-x86_64-ebs"</span>,</span><br><span class="line">    <span class="string">"amzn-ami-vpc-nat-2018.03.0.20190514-x86_64-ebs"</span></span><br><span class="line">]</span><br><span class="line">bogon:aws-test kook$ aws --profile hk  ec2 describe-images --owners amazon --filters 'Name=name,Values=amzn2-ami-hvm-2.0.20190508-x86_64-gp2' 'Name=state,Values=available' --output json | jq -r '.Images | sort_by(.CreationDate) | last(.[]).ImageId'</span><br><span class="line">ami-6fe0981e</span><br></pre></td></tr></table></figure><p>补充：获取–owners支持的参数。<br>注意点1：分别用amazon和aws-marketplace去取<br>注意点2：CentOS、centos、SLES、SuSE、sles是不一样的。区别大小写。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">localhost:<span class="built_in">test</span> kook$ aws ec2 describe-images <span class="built_in">help</span></span><br><span class="line">...</span><br><span class="line">       --owners (list)</span><br><span class="line">          Filters  the  images  by  the owner. Specify an AWS account ID, self</span><br><span class="line">          (owner is the sender of the request), or an AWS owner  <span class="built_in">alias</span>  (valid</span><br><span class="line">          values  are  amazon  |  aws-marketplace | microsoft ). Omitting this</span><br><span class="line">          option returns all images <span class="keyword">for</span> <span class="built_in">which</span>  you  have  launch  permissions,</span><br><span class="line">          regardless of ownership.</span><br><span class="line"></span><br><span class="line">       Syntax:</span><br><span class="line"></span><br><span class="line">          <span class="string">"string"</span> <span class="string">"string"</span> ...</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>新增：20190820<br>三：SuSE、RedHat的获取<br>发现用上面的方法无法正常获取到SuSE/RedHat所有的列表信息，既不在amazon，也不在aws-marketplace里面。<br>首先通过图形Console去Launch Instance,随便找一个SuSE或RedHat得到ami-id，然后查询。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">MacBook-Pro:aws jialiu$ aws ec2 describe-images --image-ids ami-0c85065910d84c419</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"Images"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"Architecture"</span>: <span class="string">"x86_64"</span>,</span><br><span class="line">            <span class="attr">"CreationDate"</span>: <span class="string">"2018-10-04T22:15:35.000Z"</span>,</span><br><span class="line">            <span class="attr">"ImageId"</span>: <span class="string">"ami-0c85065910d84c419"</span>,</span><br><span class="line">            <span class="attr">"ImageLocation"</span>: <span class="string">"841869936221/suse-sles-12-sp3-v20181004-hvm-ssd-x86_64"</span>,</span><br><span class="line">            <span class="attr">"ImageType"</span>: <span class="string">"machine"</span>,</span><br><span class="line">            <span class="attr">"Public"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">"OwnerId"</span>: <span class="string">"841869936221"</span>,</span><br><span class="line">            <span class="attr">"State"</span>: <span class="string">"available"</span>,</span><br><span class="line">            <span class="attr">"BlockDeviceMappings"</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">"DeviceName"</span>: <span class="string">"/dev/sda1"</span>,</span><br><span class="line">                    <span class="attr">"Ebs"</span>: &#123;</span><br><span class="line">                        <span class="attr">"DeleteOnTermination"</span>: <span class="literal">true</span>,</span><br><span class="line">                        <span class="attr">"SnapshotId"</span>: <span class="string">"snap-03f361c75b649a52c"</span>,</span><br><span class="line">                        <span class="attr">"VolumeSize"</span>: <span class="number">10</span>,</span><br><span class="line">                        <span class="attr">"VolumeType"</span>: <span class="string">"gp2"</span>,</span><br><span class="line">                        <span class="attr">"Encrypted"</span>: <span class="literal">false</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"Description"</span>: <span class="string">"SUSE Linux Enterprise Server 12 SP3 (HVM, 64-bit, SSD-Backed)"</span>,</span><br><span class="line">            <span class="attr">"EnaSupport"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">"Hypervisor"</span>: <span class="string">"xen"</span>,</span><br><span class="line">            <span class="attr">"Name"</span>: <span class="string">"suse-sles-12-sp3-v20181004-hvm-ssd-x86_64"</span>,</span><br><span class="line">            <span class="attr">"RootDeviceName"</span>: <span class="string">"/dev/sda1"</span>,</span><br><span class="line">            <span class="attr">"RootDeviceType"</span>: <span class="string">"ebs"</span>,</span><br><span class="line">            <span class="attr">"SriovNetSupport"</span>: <span class="string">"simple"</span>,</span><br><span class="line">            <span class="attr">"VirtualizationType"</span>: <span class="string">"hvm"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">MacBook-Pro:aws jialia$ aws ec2 describe-images --owners 841869936221 --query 'sort_by(Images, &amp;CreationDate)[].Name'</span><br><span class="line">[</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-v20180104-ecs-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-byos-v20180104-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-sap-12-sp3-byos-v20180104-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-v20180104-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-sap-12-sp2-byos-v20180104-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-manager-3-1-server-byos-v20180104-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-11-sp4-v20180104-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-11-sp4-byos-v20180104-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-manager-3-1-proxy-byos-v20180108-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-v20180215-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-byos-v20180215-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-v20180215-ecs-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-sap-12-sp3-byos-v20180215-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-sap-12-sp2-byos-v20180215-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-manager-3-1-server-byos-v20180215-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-manager-3-1-proxy-byos-v20180215-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-v20180523-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-byos-v20180523-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-sap-12-sp3-byos-v20180523-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-v20180524-ecs-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-sap-12-sp2-byos-v20180524-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-manager-3-1-server-byos-v20180524-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-manager-3-1-proxy-byos-v20180524-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-11-sp4-v20180524-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-11-sp4-byos-v20180524-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-v20180706-hvm-ssd-x86_64"</span>,</span><br><span class="line">    <span class="string">"suse-sles-12-sp3-byos-v20180706-hvm-ssd-x86_64"</span>,</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>最终我们的目标是批量获取所有region的AMI ID，具体效果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">bogon:aws-test kook$ ./get-ImageID.sh amzn2-ami-hvm-2.0.20190115-x86_64-gp2</span><br><span class="line">eu-north-1: <span class="string">"ami-6d27a913"</span></span><br><span class="line">ap-south-1: <span class="string">"ami-0937dcc711d38ef3f"</span></span><br><span class="line">eu-west-3: <span class="string">"ami-0854d53ce963f69d8"</span></span><br><span class="line">eu-west-2: <span class="string">"ami-0664a710233d7c148"</span></span><br><span class="line">eu-west-1: <span class="string">"ami-0fad7378adf284ce0"</span></span><br><span class="line">ap-northeast-3: <span class="string">"ami-02221e80207be5561"</span></span><br><span class="line">ap-northeast-2: <span class="string">"ami-018a9a930060d38aa"</span></span><br><span class="line">ap-northeast-1: <span class="string">"ami-0d7ed3ddb85b521a6"</span></span><br><span class="line">sa-east-1: <span class="string">"ami-0b04450959586da29"</span></span><br><span class="line">ca-central-1: <span class="string">"ami-0de8b8e4bc1f125fe"</span></span><br><span class="line">ap-east-1: <span class="string">"ami-062581e23e0ae6ab9"</span></span><br><span class="line">ap-southeast-1: <span class="string">"ami-04677bdaa3c2b6e24"</span></span><br><span class="line">ap-southeast-2: <span class="string">"ami-0c9d48b5db609ad6e"</span></span><br><span class="line">eu-central-1: <span class="string">"ami-0eaec5838478eb0ba"</span></span><br><span class="line">us-east-1: <span class="string">"ami-035be7bafff33b6b6"</span></span><br><span class="line">us-east-2: <span class="string">"ami-04328208f4f0cf1fe"</span></span><br><span class="line">us-west-1: <span class="string">"ami-0799ad445b5727125"</span></span><br><span class="line">us-west-2: <span class="string">"ami-032509850cf9ee54e"</span></span><br></pre></td></tr></table></figure><p>补充脚本内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$1</span>"</span> ] ; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Please pass the name of the AMI"</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">IMAGE_FILTER=<span class="string">"<span class="variable">$&#123;1&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">declare</span> -a REGIONS=($( aws --profile hk ec2 describe-regions --output json | jq <span class="string">'.Regions[].RegionName'</span> | sed <span class="string">'s/\"//g'</span> ))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;REGIONS[@]&#125;</span>"</span></span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">     ami=$(aws --profile hk ec2 describe-images --query <span class="string">'Images[*].[ImageId]'</span> --filters <span class="string">"Name=name,Values=<span class="variable">$&#123;IMAGE_FILTER&#125;</span>"</span> --region <span class="variable">$&#123;i&#125;</span> --output json | jq <span class="string">'.[0][0]'</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$i</span>: <span class="variable">$ami</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;目前正在做CloudFormation的一些工作相关内容，Hong Kong Region是新开的Region，所以Global的一般提供的QuickStart里面的AMI Mapping都没有HK的内容。所以需要提取一下Hong Kong的内容。&lt;/p&gt;
&lt;p&gt;概述：AM
      
    
    </summary>
    
      <category term="Automation" scheme="http://blog.jiazhe.space/categories/Automation/"/>
    
    
      <category term="CloudFormation" scheme="http://blog.jiazhe.space/tags/CloudFormation/"/>
    
  </entry>
  
  <entry>
    <title>Cmd-Markdown-edit</title>
    <link href="http://blog.jiazhe.space/2018/08/14/Cmd-Markdown-edit/"/>
    <id>http://blog.jiazhe.space/2018/08/14/Cmd-Markdown-edit/</id>
    <published>2018-08-14T14:45:11.000Z</published>
    <updated>2019-01-07T14:21:08.454Z</updated>
    
    <content type="html"><![CDATA[<h1 id="欢迎使用-cmd-markdown-编辑阅读器"><a class="markdownIt-Anchor" href="#欢迎使用-cmd-markdown-编辑阅读器"></a> 欢迎使用 Cmd Markdown 编辑阅读器</h1><hr><p>我们理解您需要更便捷更高效的工具记录思想，整理笔记、知识，并将其中承载的价值传播给他人，<strong>Cmd Markdown</strong> 是我们给出的答案 —— 我们为记录思想和分享知识提供更专业的工具。 您可以使用 Cmd Markdown：</p><blockquote><ul><li>整理知识，学习笔记</li><li>发布日记，杂文，所见所想</li><li>撰写发布技术文稿（代码支持）</li><li>撰写发布学术论文（LaTeX 公式支持）</li></ul></blockquote><p><img src="https://www.zybuluo.com/static/img/logo.png" alt="cmd-markdown-logo"></p><p>除了您现在看到的这个 Cmd Markdown 在线版本，您还可以前往以下网址下载：</p><h3 id="windowsmaclinux-全平台客户端"><a class="markdownIt-Anchor" href="#windowsmaclinux-全平台客户端"></a> <a href="https://www.zybuluo.com/cmd/" target="_blank" rel="noopener">Windows/Mac/Linux 全平台客户端</a></h3><blockquote><p>请保留此份 Cmd Markdown 的欢迎稿兼使用说明，如需撰写新稿件，点击顶部工具栏右侧的 <i class="icon-file"></i> <strong>新文稿</strong> 或者使用快捷键 <code>Ctrl+Alt+N</code>。</p></blockquote><hr><h2 id="什么是-markdown"><a class="markdownIt-Anchor" href="#什么是-markdown"></a> 什么是 Markdown</h2><p>Markdown 是一种方便记忆、书写的纯文本标记语言，用户可以使用这些标记符号以最小的输入代价生成极富表现力的文档：譬如您正在阅读的这份文档。它使用简单的符号标记不同的标题，分割不同的段落，<strong>粗体</strong> 或者 <em>斜体</em> 某些文字，更棒的是，它还可以</p><h3 id="1-制作一份待办事宜-todo-列表"><a class="markdownIt-Anchor" href="#1-制作一份待办事宜-todo-列表"></a> 1. 制作一份待办事宜 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#13-%E5%BE%85%E5%8A%9E%E4%BA%8B%E5%AE%9C-todo-%E5%88%97%E8%A1%A8" target="_blank" rel="noopener">Todo 列表</a></h3><ul><li>[ ] 支持以 PDF 格式导出文稿</li><li>[ ] 改进 Cmd 渲染算法，使用局部渲染技术提高渲染效率</li><li>[x] 新增 Todo 列表功能</li><li>[x] 修复 LaTex 公式渲染问题</li><li>[x] 新增 LaTex 公式编号功能</li></ul><h3 id="2-书写一个质能守恒公式"><a class="markdownIt-Anchor" href="#2-书写一个质能守恒公式"></a> 2. 书写一个质能守恒公式<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mo>=</mo><mi>m</mi><msup><mi>c</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E=mc^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8641079999999999em;"></span><span class="strut bottom" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord"><span class="mord mathit">c</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p><h3 id="3-高亮一段代码"><a class="markdownIt-Anchor" href="#3-高亮一段代码"></a> 3. 高亮一段代码<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@requires_authorization</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeClass</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># A comment</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'hello world'</span></span><br></pre></td></tr></table></figure><h3 id="4-高效绘制-流程图"><a class="markdownIt-Anchor" href="#4-高效绘制-流程图"></a> 4. 高效绘制 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#7-%E6%B5%81%E7%A8%8B%E5%9B%BE" target="_blank" rel="noopener">流程图</a></h3><pre class="mermaid"> graph LR;    开始-->条件B;    条件A-->条件C;    条件B-->条件D;    条件C-->条件D;    条件A-->条件D;    开始-->条件C;    开始-->条件A;    条件D-->结束;</pre><h3 id="5-高效绘制-序列图"><a class="markdownIt-Anchor" href="#5-高效绘制-序列图"></a> 5. 高效绘制 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#8-%E5%BA%8F%E5%88%97%E5%9B%BE" target="_blank" rel="noopener">序列图</a></h3><pre class="mermaid">sequenceDiagramAlice->Bob: Hello Bob, how are you?Note right of Bob: Bob thinksBob-->Alice: I am good thanks!</pre><h3 id="6-高效绘制-甘特图"><a class="markdownIt-Anchor" href="#6-高效绘制-甘特图"></a> 6. 高效绘制 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#9-%E7%94%98%E7%89%B9%E5%9B%BE" target="_blank" rel="noopener">甘特图</a></h3><pre class="mermaid">gantt    title 项目开发流程    section 项目确定        需求分析       :a1, 2016-06-22, 3d        可行性报告     :after a1, 5d        概念验证       : 5d    section 项目实施        概要设计      :2016-07-05  , 5d        详细设计      :2016-07-08, 10d        编码          :2016-07-15, 10d        测试          :2016-07-22, 5d    section 发布验收        发布: 2d        验收: 3d</pre><h3 id="7-绘制表格"><a class="markdownIt-Anchor" href="#7-绘制表格"></a> 7. 绘制表格</h3><table><thead><tr><th>项目</th><th style="text-align:right">价格</th><th style="text-align:center">数量</th></tr></thead><tbody><tr><td>计算机</td><td style="text-align:right">$1600</td><td style="text-align:center">5</td></tr><tr><td>手机</td><td style="text-align:right">$12</td><td style="text-align:center">12</td></tr><tr><td>管线</td><td style="text-align:right">$1</td><td style="text-align:center">234</td></tr></tbody></table><h3 id="8-更详细语法说明"><a class="markdownIt-Anchor" href="#8-更详细语法说明"></a> 8. 更详细语法说明</h3><p>想要查看更详细的语法说明，可以参考我们准备的 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown" target="_blank" rel="noopener">Cmd Markdown 简明语法手册</a>，进阶用户可以参考 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#cmd-markdown-%E9%AB%98%E9%98%B6%E8%AF%AD%E6%B3%95%E6%89%8B%E5%86%8C" target="_blank" rel="noopener">Cmd Markdown 高阶语法手册</a> 了解更多高级功能。</p><p>总而言之，不同于其它 <em>所见即所得</em> 的编辑器：你只需使用键盘专注于书写文本内容，就可以生成印刷级的排版格式，省却在键盘和工具栏之间来回切换，调整内容和格式的麻烦。<strong>Markdown 在流畅的书写和印刷级的阅读体验之间找到了平衡。</strong> 目前它已经成为世界上最大的技术分享网站 GitHub 和 技术问答网站 StackOverFlow 的御用书写格式。</p><hr><h2 id="什么是-cmd-markdown"><a class="markdownIt-Anchor" href="#什么是-cmd-markdown"></a> 什么是 Cmd Markdown</h2><p>您可以使用很多工具书写 Markdown，但是 Cmd Markdown 是这个星球上我们已知的、最好的 Markdown 工具——没有之一 ：）因为深信文字的力量，所以我们和你一样，对流畅书写，分享思想和知识，以及阅读体验有极致的追求，我们把对于这些诉求的回应整合在 Cmd Markdown，并且一次，两次，三次，乃至无数次地提升这个工具的体验，最终将它演化成一个 <strong>编辑/发布/阅读</strong> Markdown 的在线平台——您可以在任何地方，任何系统/设备上管理这里的文字。</p><h3 id="1-实时同步预览"><a class="markdownIt-Anchor" href="#1-实时同步预览"></a> 1. 实时同步预览</h3><p>我们将 Cmd Markdown 的主界面一分为二，左边为<strong>编辑区</strong>，右边为<strong>预览区</strong>，在编辑区的操作会实时地渲染到预览区方便查看最终的版面效果，并且如果你在其中一个区拖动滚动条，我们有一个巧妙的算法把另一个区的滚动条同步到等价的位置，超酷！</p><h3 id="2-编辑工具栏"><a class="markdownIt-Anchor" href="#2-编辑工具栏"></a> 2. 编辑工具栏</h3><p>也许您还是一个 Markdown 语法的新手，在您完全熟悉它之前，我们在 <strong>编辑区</strong> 的顶部放置了一个如下图所示的工具栏，您可以使用鼠标在工具栏上调整格式，不过我们仍旧鼓励你使用键盘标记格式，提高书写的流畅度。</p><p><img src="https://www.zybuluo.com/static/img/toolbar-editor.png" alt="tool-editor"></p><h3 id="3-编辑模式"><a class="markdownIt-Anchor" href="#3-编辑模式"></a> 3. 编辑模式</h3><p>完全心无旁骛的方式编辑文字：点击 <strong>编辑工具栏</strong> 最右侧的拉伸按钮或者按下 <code>Ctrl + M</code>，将 Cmd Markdown 切换到独立的编辑模式，这是一个极度简洁的写作环境，所有可能会引起分心的元素都已经被挪除，超清爽！</p><h3 id="4-实时的云端文稿"><a class="markdownIt-Anchor" href="#4-实时的云端文稿"></a> 4. 实时的云端文稿</h3><p>为了保障数据安全，Cmd Markdown 会将您每一次击键的内容保存至云端，同时在 <strong>编辑工具栏</strong> 的最右侧提示 <code>已保存</code> 的字样。无需担心浏览器崩溃，机器掉电或者地震，海啸——在编辑的过程中随时关闭浏览器或者机器，下一次回到 Cmd Markdown 的时候继续写作。</p><h3 id="5-离线模式"><a class="markdownIt-Anchor" href="#5-离线模式"></a> 5. 离线模式</h3><p>在网络环境不稳定的情况下记录文字一样很安全！在您写作的时候，如果电脑突然失去网络连接，Cmd Markdown 会智能切换至离线模式，将您后续键入的文字保存在本地，直到网络恢复再将他们传送至云端，即使在网络恢复前关闭浏览器或者电脑，一样没有问题，等到下次开启 Cmd Markdown 的时候，她会提醒您将离线保存的文字传送至云端。简而言之，我们尽最大的努力保障您文字的安全。</p><h3 id="6-管理工具栏"><a class="markdownIt-Anchor" href="#6-管理工具栏"></a> 6. 管理工具栏</h3><p>为了便于管理您的文稿，在 <strong>预览区</strong> 的顶部放置了如下所示的 <strong>管理工具栏</strong>：</p><p><img src="https://www.zybuluo.com/static/img/toolbar-manager.jpg" alt="tool-manager"></p><p>通过管理工具栏可以：</p><p><i class="icon-share"></i> 发布：将当前的文稿生成固定链接，在网络上发布，分享<br><i class="icon-file"></i> 新建：开始撰写一篇新的文稿<br><i class="icon-trash"></i> 删除：删除当前的文稿<br><i class="icon-cloud"></i> 导出：将当前的文稿转化为 Markdown 文本或者 Html 格式，并导出到本地<br><i class="icon-reorder"></i> 列表：所有新增和过往的文稿都可以在这里查看、操作<br><i class="icon-pencil"></i> 模式：切换 普通/Vim/Emacs 编辑模式</p><h3 id="7-阅读工具栏"><a class="markdownIt-Anchor" href="#7-阅读工具栏"></a> 7. 阅读工具栏</h3><p><img src="https://www.zybuluo.com/static/img/toolbar-reader.jpg" alt="tool-manager"></p><p>通过 <strong>预览区</strong> 右上角的 <strong>阅读工具栏</strong>，可以查看当前文稿的目录并增强阅读体验。</p><p>工具栏上的五个图标依次为：</p><p><i class="icon-list"></i> 目录：快速导航当前文稿的目录结构以跳转到感兴趣的段落<br><i class="icon-chevron-sign-left"></i> 视图：互换左边编辑区和右边预览区的位置<br><i class="icon-adjust"></i> 主题：内置了黑白两种模式的主题，试试 <strong>黑色主题</strong>，超炫！<br><i class="icon-desktop"></i> 阅读：心无旁骛的阅读模式提供超一流的阅读体验<br><i class="icon-fullscreen"></i> 全屏：简洁，简洁，再简洁，一个完全沉浸式的写作和阅读环境</p><h3 id="8-阅读模式"><a class="markdownIt-Anchor" href="#8-阅读模式"></a> 8. 阅读模式</h3><p>在 <strong>阅读工具栏</strong> 点击 <i class="icon-desktop"></i> 或者按下 <code>Ctrl+Alt+M</code> 随即进入独立的阅读模式界面，我们在版面渲染上的每一个细节：字体，字号，行间距，前背景色都倾注了大量的时间，努力提升阅读的体验和品质。</p><h3 id="9-标签-分类和搜索"><a class="markdownIt-Anchor" href="#9-标签-分类和搜索"></a> 9. 标签、分类和搜索</h3><p>在编辑区任意行首位置输入以下格式的文字可以标签当前文档：</p><p>标签： 未分类</p><p>标签以后的文稿在【文件列表】（Ctrl+Alt+F）里会按照标签分类，用户可以同时使用键盘或者鼠标浏览查看，或者在【文件列表】的搜索文本框内搜索标题关键字过滤文稿，如下图所示：</p><p><img src="https://www.zybuluo.com/static/img/file-list.png" alt="file-list"></p><h3 id="10-文稿发布和分享"><a class="markdownIt-Anchor" href="#10-文稿发布和分享"></a> 10. 文稿发布和分享</h3><p>在您使用 Cmd Markdown 记录，创作，整理，阅读文稿的同时，我们不仅希望它是一个有力的工具，更希望您的思想和知识通过这个平台，连同优质的阅读体验，将他们分享给有相同志趣的人，进而鼓励更多的人来到这里记录分享他们的思想和知识，尝试点击 <i class="icon-share"></i> (Ctrl+Alt+P) 发布这份文档给好友吧！</p><hr><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>支持 <strong>LaTeX</strong> 编辑显示支持，例如：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^n a_i=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0500099999999999em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>， 访问 <a href="http://meta.math.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference" target="_blank" rel="noopener">MathJax</a> 参考更多使用方法。 <a href="#fnref1" class="footnote-backref">↩︎</a></p></li><li id="fn2" class="footnote-item"><p>代码高亮功能支持包括 Java, Python, JavaScript 在内的，<strong>四十一</strong>种主流编程语言。 <a href="#fnref2" class="footnote-backref">↩︎</a></p></li></ol></section>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;欢迎使用-cmd-markdown-编辑阅读器&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#欢迎使用-cmd-markdown-编辑阅读器&quot;&gt;&lt;/a&gt; 欢迎使用 Cmd Markdown 编辑阅读器&lt;/h1&gt;
&lt;hr&gt;
&lt;p&gt;我们理解
      
    
    </summary>
    
      <category term="基础学习" scheme="http://blog.jiazhe.space/categories/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://blog.jiazhe.space/2018/08/12/hello-world/"/>
    <id>http://blog.jiazhe.space/2018/08/12/hello-world/</id>
    <published>2018-08-12T13:22:30.000Z</published>
    <updated>2019-05-22T10:16:36.960Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2><h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
  </entry>
  
</feed>
